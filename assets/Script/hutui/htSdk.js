!function (t, r) { for (var n in r) t[n] = r[n] }(exports, function (t) { var r = {}; function n(e) { if (r[e]) return r[e].exports; var o = r[e] = { i: e, l: !1, exports: {} }; return t[e].call(o.exports, o, o.exports, n), o.l = !0, o.exports } return n.m = t, n.c = r, n.d = function (t, r, e) { n.o(t, r) || Object.defineProperty(t, r, { configurable: !1, enumerable: !0, get: e }) }, n.r = function (t) { Object.defineProperty(t, "__esModule", { value: !0 }) }, n.n = function (t) { var r = t && t.__esModule ? function () { return t.default } : function () { return t }; return n.d(r, "a", r), r }, n.o = function (t, r) { return Object.prototype.hasOwnProperty.call(t, r) }, n.p = "", n(n.s = 1) }([function (t, r, n) { "use strict"; Object.defineProperty(r, "__esModule", { value: !0 }); var e = function () { function t() { } return t.lerr = function () { for (var t = [], r = 0; r < arguments.length; r++)t[r] = arguments[r]; t.unshift("====>"), console.error.apply(window, t) }, t.llog = function () { for (var t = [], r = 0; r < arguments.length; r++)t[r] = arguments[r]; t.unshift("====>"), console.log.apply(window, t) }, t.twoInt = function (t) { return t < 10 ? "0" + t : t }, t.todayStr = function () { var r = new Date; return "" + r.getFullYear() + t.twoInt(r.getMonth() + 1) + t.twoInt(r.getDate()) }, t.randomInt = function (t, r) { return Math.floor(Math.random() * (r - t + 1) + t) }, t.saveData = function (t, r) { var n = window.localStorage; n && n.setItem("kcSdk_" + t, r) }, t.loadData = function (t) { var r = window.localStorage; if (r) { var n = r.getItem("kcSdk_" + t); if (n) return n } return null }, t.encodeUTF8 = function (t) { var r, n, e, o = []; for (r = 0; r < t.length; r++)(n = t.charCodeAt(r)) < 128 ? o.push(n) : n < 2048 ? o.push(192 + (n >> 6 & 31), 128 + (63 & n)) : ((e = 55296 ^ n) >> 10 == 0 ? (n = (e << 10) + (56320 ^ t.charCodeAt(++r)) + 65536, o.push(240 + (n >> 18 & 7), 128 + (n >> 12 & 63))) : o.push(224 + (n >> 12 & 15)), o.push(128 + (n >> 6 & 63), 128 + (63 & n))); return o }, t.s = function (r) { var n, e, o, i = new Uint8Array(t.encodeUTF8(r)), a = 16 + (i.length + 8 >>> 6 << 4); for ((r = new Uint8Array(a << 2)).set(new Uint8Array(i.buffer)), r = new Uint32Array(r.buffer), o = new DataView(r.buffer), n = 0; n < a; n++)r[n] = o.getUint32(n << 2); r[i.length >> 2] |= 128 << 24 - 8 * (3 & i.length), r[a - 1] = i.length << 3; var u = [], s = [function () { return f[1] & f[2] | ~f[1] & f[3] }, function () { return f[1] ^ f[2] ^ f[3] }, function () { return f[1] & f[2] | f[1] & f[3] | f[2] & f[3] }, function () { return f[1] ^ f[2] ^ f[3] }], l = function (t, r) { return t << r | t >>> 32 - r }, c = [1518500249, 1859775393, -1894007588, -899497514], f = [1732584193, -271733879, null, null, -1009589776]; for (f[2] = ~f[0], f[3] = ~f[1], n = 0; n < r.length; n += 16) { var h = f.slice(0); for (e = 0; e < 80; e++)u[e] = e < 16 ? r[n + e] : l(u[e - 3] ^ u[e - 8] ^ u[e - 14] ^ u[e - 16], 1), o = l(f[0], 5) + s[e / 20 | 0]() + f[4] + u[e] + c[e / 20 | 0] | 0, f[1] = l(f[1], 30), f.pop(), f.unshift(o); for (e = 0; e < 5; e++)f[e] = f[e] + h[e] | 0 } for (o = new DataView(new Uint32Array(f).buffer), n = 0; n < 5; n++)f[n] = o.getUint32(n << 2); return Array.prototype.map.call(new Uint8Array(new Uint32Array(f).buffer), function (t) { return (t < 16 ? "0" : "") + t.toString(16) }).join("") }, t.b = function (t) { var r = []; for (var n in t) r.push(n); r = r.sort(); for (var e = "", o = 0; o < r.length; o++) { var i = t[r[o]]; "object" == typeof i && (i = this.b(i)), e += r[o] + i } return e }, t.a = function (r, n, e) { var o = []; for (var i in r) null !== r[i] && void 0 !== r[i] ? o.push(i) : delete r[i]; o = o.sort(); var a = t.b(r); return n && (a += n), a += e || "pH0Xhyenu2e1zdUg", t.s(a) }, t.jax = function (r, n, e) { e || (e = function (r) { if (r) return t.lerr(r) }); var o = new XMLHttpRequest, i = (new Date).getTime(); n.s = t.a(n, i), o.open("POST", r, !0), o.setRequestHeader("Content-Type", "application/json; charset=utf-8"), o.setRequestHeader("ts", "" + i); var a = JSON.stringify(n); o.send(a), o.onload = function () { if (200 == o.status) { var r = { jaxERR: "" + o.responseText }; try { r = JSON.parse(o.responseText) } catch (r) { return t.lerr(r), e(null, { re: "1111", err: "jsonErr:" + o.responseText }) } return e(null, r) } return e(null, { re: "9" + o.status }) } }, t }(); r.jax = e.jax, r.llog = e.llog, r.lerr = e.lerr, r.saveData = e.saveData, r.loadData = e.loadData, r.randomInt = e.randomInt, r.todayStr = e.todayStr }, function (t, r, n) { "use strict"; Object.defineProperty(r, "__esModule", { value: !0 }); var e = n(0), o = function () { function t() { this.version = "1.2.0", this.navGap = 3e3, this.lastNavT = 0, this.htHost = "https://dk.gametdd.com/htApi/ht_api/", this.picType = "jpg" } return t.instance = function () { return t.me ? t.me : (t.me = new t, t.me) }, t.prototype.getUid = function () { return t.Uid ? t.Uid : (t.Uid = e.loadData("uid"), t.Uid || "null") }, t.prototype.setUid = function (r) { r && t.Uid !== r && (t.Uid = r, e.saveData("uid", r)) }, t.prototype.jht = function (t, r, n) { r.v = this.version, e.jax(this.htHost + t, r, function (t, r) { return t || !r ? (e.llog("jhtERR", t), n(t || new Error("no re"))) : 0 !== r.re ? (e.llog("jht FAILED!" + JSON.stringify(r)), n(new Error("err:" + r.re))) : void n(null, r) }) }, t.prototype.init = function (r, n, o) { var i = this; e.llog("HTS init v:" + this.version + "," + r), t.Gid = r; var a = e.loadData("htHost"); a && (this.htHost = a); var u = e.loadData("picType"); u && (this.picType = u); var s = { gid: r, uid: this.getUid(), query: n || "null" }; e.llog("init start..." + this.picType + "," + this.htHost), this.jht("init", s, function (r, n) { if (r) o(r); else { e.llog("init done:" + n.re), i.setUid(n.uid), n.iconPre && (t.IconPre = n.iconPre), n.picType && (i.picType = n.picType, e.saveData("picType", n.picType)), n.navGap && (i.navGap = n.navGap); for (var a = [], u = 0; u < n.midArr.length; u++) { var s = n.midArr[u], l = ""; n.vArr && n.vArr.length === n.midArr.length && 0 !== parseInt(n.vArr[u]) && (l = "_" + n.vArr[u]), a.push({ iconUrl: n.iconPre + s + l + "." + i.picType, mid: s }) } o(null, a), n.htHost && n.htHost !== i.htHost && (i.htHost = n.htHost, e.saveData("htHost", n.htHost)) } }) }, t.prototype.getBox = function (r, n) { var o = this; if (!t.IconPre) return e.llog("htSdk 未初始化!!" + t.IconPre), n(new Error("htSdk 未初始化")); var i = { bid: r }; this.jht("getBox", i, function (e, i) { if (e) return n(e); if (!i.arr || i.arr.length <= 0) return n(new Error("服务配置有误bid:" + r)); for (var a = [], u = 0; u < i.arr.length; u++) { for (var s = i.arr[u], l = [], c = 0; c < s.length; c++) { var f = s[c].split("@"), h = "", p = ""; f.length >= 4 && "0" !== f[3] && (h = "_" + f[3]), f.length >= 5 && (p = f[4]), l.push({ jumpKey: f[1], mid: f[0], iconUrl: t.IconPre + f[0] + h + "." + o.picType, txt: f[2], mark: p, query: "mid=" + f[0] + "&bid=" + r + "&uid=" + t.Uid + "&po=" + u }) } a.push(l) } n(null, a) }) }, t.prototype.navTo = function (r, n, o, i) { var a = this, u = (new Date).getTime(); if (u - this.lastNavT < this.navGap) e.llog("navTo too"); else { this.lastNavT = u; var s = { gid: r || t.Gid, uid: this.getUid(), bid: n, mid: o }; n ? o ? (i && (s.fail = "true"), e.llog("navTo", JSON.stringify(s)), this.jht("navTo", s, function (t, r) { t || a.setUid(r.uid) })) : e.llog("navTo 无mid") : e.llog("navTo 无bid") } }, t.prototype.navFrom = function (r, n) { var o = this; if (n) { t.Gid = r; var i = { gid: r, uid: this.getUid(), query: n || "null" }; e.llog("navFrom", JSON.stringify(i)), this.jht("navFrom", i, function (t, r) { t || o.setUid(r.uid) }) } else e.llog("navFrom query is empty!" + n) }, t.prototype.jlog = function (r, n, o) { var i = this; if (t.Gid) { var a = { act: r, gid: t.Gid, uid: this.getUid(), data: n, user: o }; e.llog("jlog", JSON.stringify(a)), this.jht("jlog", a, function (t, r) { t || i.setUid(r.uid) }) } else e.llog("jlog no gid", r, n) }, t.prototype.getSharePic = function (t, r) { this.jht("getSharePic", { game: t }, r) }, t.prototype.shareTo = function (t) { this.jht("shareTo", { wxPicId: t }, function (r) { r ? e.lerr(r) : e.llog("shareTo OK," + t) }) }, t.prototype.shareFrom = function (t) { this.jht("shareFrom", { wxPicId: t }, function (r) { r ? e.lerr(r) : e.llog("shareFrom OK," + t) }) }, t.prototype.jreq = function (t, r, n) { e.jax(t, r, n) }, t }(); r.default = o.instance() }]));
//# sourceMappingURL=htSdk.js.map